<div class="dashboard-container">
  <!-- Header -->
  <div class="dashboard-header">
    <h1>Manufacturing ERP Dashboard</h1>
    <p class="subtitle">Welcome back, Admin | Real-time inventory and analytics</p>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Loading dashboard data...</p>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!isLoading && dashboardData" class="dashboard-content">
    <!-- KPI Cards -->
    <div class="kpi-cards">
      <mat-card class="kpi-card">
        <mat-card-content>
          <div class="kpi-icon products">
            <mat-icon>inventory</mat-icon>
          </div>
          <div class="kpi-info">
            <span class="kpi-value">{{ dashboardData.totalProducts }}</span>
            <span class="kpi-label">Total Products</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="kpi-card">
        <mat-card-content>
          <div class="kpi-icon suppliers">
            <mat-icon>business</mat-icon>
          </div>
          <div class="kpi-info">
            <span class="kpi-value">{{ dashboardData.totalSuppliers }}</span>
            <span class="kpi-label">Suppliers</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="kpi-card">
        <mat-card-content>
          <div class="kpi-icon warehouses">
            <mat-icon>warehouse</mat-icon>
          </div>
          <div class="kpi-info">
            <span class="kpi-value">{{ dashboardData.totalWarehouses }}</span>
            <span class="kpi-label">Warehouses</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="kpi-card warning">
        <mat-card-content>
          <div class="kpi-icon low-stock">
            <mat-icon>warning</mat-icon>
          </div>
          <div class="kpi-info">
            <span class="kpi-value">{{ dashboardData.lowStockItems }}</span>
            <span class="kpi-label">Low Stock Items</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="kpi-card">
        <mat-card-content>
          <div class="kpi-icon orders">
            <mat-icon>receipt_long</mat-icon>
          </div>
          <div class="kpi-info">
            <span class="kpi-value">{{ dashboardData.pendingOrders }}</span>
            <span class="kpi-label">Pending Orders</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="kpi-card highlight">
        <mat-card-content>
          <div class="kpi-icon value">
            <mat-icon>attach_money</mat-icon>
          </div>
          <div class="kpi-info">
            <span class="kpi-value">{{ formatCurrency(dashboardData.totalInventoryValue) }}</span>
            <span class="kpi-label">Total Inventory Value</span>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Charts Row -->
    <div class="charts-row">
      <!-- Stock by Category Chart -->
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Stock Value by Category</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-container">
            <canvas baseChart
              [data]="categoryChartData"
              [options]="chartOptions"
              type="pie">
            </canvas>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Monthly Orders Chart -->
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Monthly Order Amounts</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-container">
            <canvas baseChart
              [data]="ordersChartData"
              [options]="chartOptions"
              type="bar">
            </canvas>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Data Tables Row -->
    <div class="tables-row">
      <!-- Top Products -->
      <mat-card class="table-card">
        <mat-card-header>
          <mat-card-title>Top Products by Value</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <table mat-table [dataSource]="dashboardData.topProducts" class="products-table">
            <ng-container matColumnDef="productName">
              <th mat-header-cell *matHeaderCellDef>Product Name</th>
              <td mat-cell *matCellDef="let item">{{ item.productName }}</td>
            </ng-container>

            <ng-container matColumnDef="quantityInStock">
              <th mat-header-cell *matHeaderCellDef>Qty in Stock</th>
              <td mat-cell *matCellDef="let item">{{ item.quantityInStock }}</td>
            </ng-container>

            <ng-container matColumnDef="totalValue">
              <th mat-header-cell *matHeaderCellDef>Total Value</th>
              <td mat-cell *matCellDef="let item">{{ formatCurrency(item.totalValue) }}</td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="['productName', 'quantityInStock', 'totalValue']"></tr>
            <tr mat-row *matRowDef="let row; columns: ['productName', 'quantityInStock', 'totalValue'];"></tr>
          </table>
        </mat-card-content>
      </mat-card>

      <!-- Recent Activities -->
      <mat-card class="table-card">
        <mat-card-header>
          <mat-card-title>Recent Activities</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <mat-list class="activity-list">
            <mat-list-item *ngFor="let activity of dashboardData.recentActivities">
              <mat-icon matListItemIcon [color]="getActivityColor(activity.activityType)">
                {{ getActivityIcon(activity.activityType) }}
              </mat-icon>
              <div matListItemTitle>{{ activity.activityType }}</div>
              <div matListItemLine>{{ activity.description }}</div>
            </mat-list-item>
          </mat-list>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>
